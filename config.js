let descriptionDiv =
  '<p style="text-align:center;margin-top:0px; padding-top:50px">Scroll to see its range map<br>▼</p>' +
  '<div class="legend"><div class="box breeding"></div><p>&nbsp Breeding season: April - October </p><div class="box non-breeding"></div><p>&nbsp Non-breeding season: November - March</p></div>';

let divChapter1 =
  "<p style='max-width:600px; margin-left:auto; margin-right:auto'>The Atlantic Coast population is only one part of the species' range. In the late spring and early summer, piping plovers travel to the coast, Great Lake and Northern Great Plains, where they <span style='background-color:#023e8a;color:white'>mate, hatch, forage</span>, and then bring chicks back to the southern states and even further <span style='background-color:#7fb6c6;color:white'>for the winter</span>.</p>";

let divChapter2 =
  "<p>On the northeastern coast, scientists have studied their reproduction and behavior for decades. In 1985, <a href='https://www.vtshorebirds.org/our-vision'>Virginia Tech Shorebird Program</a> recruited a team of researchers to monitor and study breeding plovers in <span style='font-weight:800'>Virginia</span> and <span style='font-weight:800'>Maryland</span>.</p>";

let divChapter31 =
  "<p>It expanded to <span style='font-weight:800'>New York</span> in 1992. They found that plover demography and growth are dependent on habitat availability, and the amount of human recreation in the areas, and is influenced by storm disturbance.</p>" 

let divChapter32 =
  "<p>After the historical <span style='color:#ae2012; font-weight:700'>Hurricane Sandy</span> hit the Atlantic coast in 2012, they started to look into how it might change the overall suitability of nesting and how shorebirds respond to the change.</p>" +
  "<p class='legend-bar'></p>" +
  "<p style='margrin-top:0; font-size:small'>less damage --> more damage</p>";


let divChapter4 =
"<p>In 2019, the research team led by Katie M. Walker published the first <a href='https://esajournals.onlinelibrary.wiley.com/doi/10.1002/ecs2.2771'>study</a> on the hurricane overwashing effect. They found that piping plover abundance increased 93% by 2018 from pre-Hurricane Sandy abundances on <span style='font-weight:800'>Fire Island</span> and <span style='font-weight:800'>Westhampton Island</span>, New York, with most pairs nesting in new habitats created by the storm.</p>" +
"<img src='images/fireisland.gif'>" +
"<p class='imageCredit'> Hurricane Sandy removed vegetations and created more sandy areas favored by piping plovers </p>" +
"<p>The study also found that some engineered habitats, including manipulated dunes and restoration areas, are gaining piping plover populations too. However, since these places were meant to reduce future overwash and increase human activities, the article suggested that dune development should not be considered a management strategy.</p>" +
"<p>Similarly, another U.S. Geological Survey research team led by Sara Zeigler, also found that a certain amount of increase in sea rise and increased likelihood of overwash can benefit the shorebirds. Based on the prediction model, as rates of shoreline erosion increase, Fire Island would become narrower and flatter, with more flooding in housing communities and businesses on the island. Instead, shorebirds like the piping plover would move to new habitats as long as hard structures like buildings or seawalls do not block sand movement.</p>"+
"<p>“I think we're still very much in the learning phase,” said Zeigler. She pointed out that scientists are struggling to find that balance between when a sea-level rise going to be healthy for some of these ecosystems and when is going to be too much. “We will get to a point inevitably where there's so much water and the storms are so powerful, that we're going to start to see our islands disintegrate. And we did see that in some places in the Gulf.”</p>"
;

let divChapter5 =
"<p>Shelby Casas, the Coastal Program Associate at Audubon New York, also pointed out that the early storm during the nesting season can have fatal effects on the shorebirds. The flood can wash out a bunch of nests where birds have already laid eggs and the birds have to restart again.</p>" +
"<p>On July 7, Casas just finished an outreach lecture at <span style='font-weight:800'>Jones Beach Energy & Nature Center</span>. When she took a walk on the west end of the beach afterward, she noticed a sign saying ‘no dog on this site’ was ripped off from the fence and broken from the middle.</p>" +
'<img src="images/shelby-sign.jpeg">' +
"<p class='imageCredit'> Shelby Casas, at the west end of Jones Beach, July 9 </p>" +
"<p>Mia Ramirez, Environmental Education Assistant from the Jones Beach State Park, who accompanied Casas for the walk, said that lots of people feel they have an ownership of the beach. “They're like, why do I have to worry about this bird? I've been taking my dog here for years and years and years…Why is someone telling me not to (do it)?”</p>"+
"<p>Casas said she was prepared for that and will implement a new sign. There are more signs simply telling people to stay out of the shorebird nesting area before. But this year, they try to add more explanatory notes, illustrations drawn by local school kids and pictures of the birds.</p>"+
'<img src="images/mia-sign.jpg">' +
"<p class='imageCredit'> Mia Ramirez, holding a sign designed by kids, July 9 </p>" +
"<p>“Our goal this year with the signs was kind of more to draw people in…and get the message across that we don't want dogs on these beaches, but to also explain why,” said Casas.</p>" +
"<p>This is a part of a three-month <a href='https://ny.audubon.org/news/can-individual-actions-save-threatened-birds-two-local-beaches-chosen-beach-nesting-bird-study'>study</a> to review the outcomes of different outreach efforts conducted by Audubon New York. Apart from putting up signs, the team has organized more frequent outreach activities compared to previous years, like tabling at multiple sites along the north and the south shore that have shorebird activity.</p>" 
;

let divChapter7 =
"<p>But the difficult part is to make people aware that the birds are actually here. Not many people know that piping plovers love walking on the sand and nesting right on the beach. They are good at camouflage - it’s hard to tell them from the sand from a distance.</p>" +
"<p>On <span style='font-weight:800'>Rockaway Beach</span> in Queens, the west part of 38th Street is closed for protecting the breeding birds. A symbolic fence was put up, visuallily warning people to keep out of that areas. On the sign, the illustrations of least tern and piping plover are under the red, uppercase letters ‘Restricted Area’.</p>" +
"<p>The reason why only posted and roped off area is set up instead of permanent physical fences, is that the structure on the shoreline can be easily washed away by the high tides, according to <a href='https://kimsmithdesigns.com/2018/08/01/piping-plover-symbolic-fencing-recommendations/'>Kim Smith</a>, a wildlife conservationist and landscape designer. On some beaches, when piping plover couples start to build their nests, smaller stell-wire fences are constructed around them. The holes on the fences are big enough only for piping plovers to run through, keeping other larger predators, like feral cats and raccoons, and pets out.</p>" +
"<p>Even well-behaved pets can be a threat to the birds. Unleashed dogs can be mistaken as predators by plovers. To protect their chicks, they will pretend their wings are broken and lead the dogs away from the nest. But such a strategy may let their nest open to real predators. And the trash left by beachgoers attracts raccoons and foxes, which can disturb and eat chicks.</p>" +
"<p>Moreover, some beachgoers might spot and disturb them on purpose. More than one researcher explained that they normally don’t share the nest location data with the public because they are afraid people will find the nest and get too close to them.</p>" +
"<p>Last month, NYC Plover Project, a voluntary group, tweeted that a 12-day-old piping plover chick was stepped on by a beachgoer. After being seen dragging its broken leg on the beach in Queens, it died next to its sibling the day after.</p>" ;


var config = {
  style: "mapbox://styles/angelinejcq/cl6703tes001f14lq7f7kfvef",
  accessToken: "pk.eyJ1IjoiYW5nZWxpbmVqY3EiLCJhIjoiY2wzdTh0MzNyMjlzNzNwbTlrOHZjbnFuZCJ9.MxT1rnnswLTBYgg2y7MB1w",
  showMarkers: false,
  markerColor: "#3FB1CE",
  theme: "light",
  use3dTerrain: false,

  description: descriptionDiv,
  chapters: [
    {
      id: "rangeMap",
      alignment: "center",
      hidden: false,
      chapterDiv: divChapter1,
      location: {
        center: [-95, 37.7],
        zoom: 3.75,
        zoomSmall: 3,
        pitch: 0,
        bearing: 0,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "noIntervention",
          opacity: 0,
          duration: 300,
        },
        {
          layer: "markers",
          opacity: 0,
          duration: 300,
        },
        {
          layer: "ploverRange",
          opacity: 0.7,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "ploverRange",
          opacity: 0.7,
          duration: 300,
        },
      ],
    },
    {
      id: "easternCoast",
      alignment: "right",
      hidden: false,
      title: "",
      image: "",
      description: "",
      chapterDiv: divChapter2,
      location: {
        center: [-75.150,38.660],
        zoom: 5.73,
        zoomSmall: 3,
        pitch: 0,
        bearing: 0,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "markers",
          opacity: 1,
          duration: 300,
        },
        {
          layer: "ploverRange",
          opacity: 0.7,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
    },
    {
      id: "toNewYork",
      alignment: "right",
      hidden: false,
      title: "",
      image: "",
      description: "",
      chapterDiv: divChapter31,
      location: {
        center: [-73.586,40.506],
        zoom: 9,
        zoomSmall: 8,
        pitch: 40,
        bearing: -7,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "ploverRange",
          opacity: 0.3,
          duration: 300,
        },
      ],
      onChapterExit: [],
    },
    {
      id: "hurricaneSandy",
      alignment: "right",
      hidden: false,
      title: "",
      image: "",
      description: "",
      chapterDiv: divChapter32,
      location: {
        center: [-73.586,40.506],
        zoom: 9,
        zoomSmall: 8,
        pitch: 40,
        bearing: -7,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
        {
          layer: "sandyDamage",
          opacity: 0.7,
          duration: 300,
        },
        {
          layer: "markers",
          opacity: 0,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "sandyDamage",
          opacity: 0,
          duration: 300,
        },
      ],
    },
    {
      id: "toFireIsland",
      alignment: "full",
      hidden: false,
      title: "",
      image: "",
      description: "",
      chapterDiv: divChapter4,
      location: {
        center: [-72.978,40.667],
        zoom: 12.01,
        zoomSmall: 12,
        pitch: 40,
        bearing: -7,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
        {
          layer: "noIntervention",
          opacity: 1,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
    },
    {
      id: "toJonesBeach",
      alignment: "full",
      hidden: false,
      title: "",
      image: "",
      description: "",
      chapterDiv: divChapter5,
      location: {
        center: [-73.484,40.603],
        zoom: 11.89,
        zoomSmall: 11,
        pitch: 40,
        bearing: -7,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
    },
    {
      id: "jamaicaBay",
      alignment: "full",
      hidden: false,
      chapterDiv: divChapter7,
      location: {
        center: [-73.765,40.593],
        zoom: 11.42,
        zoomSmall: 11,
        pitch: 40,
        bearing: -7,
      },
      mapAnimation: "flyTo",
      rotateAnimation: false,
      callback: "",
      onChapterEnter: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
      onChapterExit: [
        {
          layer: "ploverRange",
          opacity: 0,
          duration: 300,
        },
      ],
    },
  ],
};